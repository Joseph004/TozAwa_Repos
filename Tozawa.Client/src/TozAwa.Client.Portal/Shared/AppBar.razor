@namespace Tozawa.Client.Portal.Shared
@using HttpClients.Helpers
@inject Tozawa.Client.Portal.Services.TokenProvider TokenProvider
@inject NavigationManager NavManager
@inherits BaseComponent


<MudAppBar Elevation="3">
    <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="ToggleSideBar" />
    @if (_showLogo)
    {
        <MudButton Link="/home" Color="Color.Inherit">
            <img src="/images/finalelogo_vit_infylld.png" asp-append-version="true" height="40px"
            width="250px" />
        </MudButton>
    }
    <MudSpacer />

    <LanguageSelection />
    <AuthorizeView>
        <Authorized>
            <LoadingScreen>
                <MudMenu AnchorOrigin="Origin.BottomCenter">
                    <ActivatorContent>
                        <MudAvatar Image="/images/profile_avatar.jpg" />
                    </ActivatorContent>
                    <ChildContent>
                        <MudMenuItem>
                            <MudText>
                                <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Person" Size="Size.Small"
                                    Color="Color.Warning">
                                </MudIcon>
                                <SystemText TextId=SystemTextId.Hello FallbackText="Hello"></SystemText>
                                <b>@context.User.Identity.Name!</b>
                            </MudText>
                        </MudMenuItem>
                        <MudDivider />
                        <MudMenuItem>
                            <MudButton OnClick="@(()=>Logout())" Color="Color.Inherit">
                                <MudText>
                                    <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Logout" Size="Size.Small"></MudIcon>
                                    <SystemText TextId=SystemTextId.Logout FallbackText="Logout"></SystemText>
                                </MudText>
                            </MudButton>
                        </MudMenuItem>
                    </ChildContent>
                </MudMenu>
            </LoadingScreen>
        </Authorized>
        <NotAuthorized>
            <LoadingScreen>
                <MudButton OnClick="@(()=>Login())" Color="Color.Inherit">
                    <MudText>
                        <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Login" Size="Size.Small"></MudIcon>
                        <SystemText TextId=SystemTextId.Login FallbackText="Login"></SystemText>
                    </MudText>
                </MudButton>
            </LoadingScreen>
        </NotAuthorized>
    </AuthorizeView>
    @* @if (_isLightMode)
        {
        <MudIconButton Icon="@Icons.Material.Filled.Brightness4" Color="Color.Inherit" OnClick="ToggleTheme" />
        }
        else
        {
        <MudIconButton Icon="@Icons.Material.Filled.Brightness5" Color="Color.Inherit" OnClick="ToggleTheme" />
        } *@
</MudAppBar>