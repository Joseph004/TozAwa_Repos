@namespace TozawaNGO.Shared
@inject NavigationManager NavManager
@inherits BaseComponent
@using TozawaNGO.Helpers


<MudAppBar Elevation="3">
    <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="ToggleSideBar" />
    @if (_showLogo)
    {
        <MudButton Href="/home" Color="Color.Inherit">
            <img src="/images/TR_Mini.png" asp-append-version="true" height="60px" width="150px" />
        </MudButton>
    }
    <MudSpacer />

    <MudText>
        <SystemText TextId=SystemTextId.ToZawaTitle Style="font-familly: cursive; font-size: max(1.2vw, 13px)"
            SystemTextTypo=Typo.h2 FallbackText="Svensk Förening för internationella arbete inom teknik och informatik"
            IsFirstLoaded="@IsFirstLoaded"></SystemText>
    </MudText>

    <MudSpacer />
    <LanguageSelection />
    <AuthorizeView>
        <Authorized>
            <MudMenu TransformOrigin="@Origin.TopCenter" AnchorOrigin="Origin.BottomCenter">
                <ActivatorContent>
                    <MudImage Src="/images/profile_avatar.jpg" Alt="Profil avatar" Height="35" Width="35" Elevation="30"
                        Class="rounded-lg" />
                </ActivatorContent>
                <ChildContent>
                    <MudMenuItem>
                        <MudText>
                            <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Person" Size="Size.Small"
                                Color="Color.Warning">
                            </MudIcon>
                            <SystemText TextId=SystemTextId.Hello FallbackText="Hello" IsFirstLoaded="@IsFirstLoaded">
                            </SystemText>
                            <b>@context.User.Identity.Name!</b>
                        </MudText>
                    </MudMenuItem>
                    <MudDivider />
                    <MudMenuItem>
                        <MudButton OnClick="@(()=>Logout())" Color="Color.Inherit">
                            <MudText>
                                <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Logout" Size="Size.Small">
                                </MudIcon>
                                <SystemText TextId=SystemTextId.Logout FallbackText="Logout"
                                    IsFirstLoaded="@IsFirstLoaded"></SystemText>
                            </MudText>
                        </MudButton>
                    </MudMenuItem>
                </ChildContent>
            </MudMenu>
        </Authorized>
        <NotAuthorized>
            <MudTooltip Class="pa-0 ma-0 opaque">
                <ChildContent>
                    <MudMenu TransformOrigin="@Origin.TopCenter" AnchorOrigin="Origin.BottomCenter">
                        <ActivatorContent>
                            <MudIcon Icon="@Icons.Material.Filled.PersonAddAlt1" Size="Size.Small"
                                Color="Color.Inherit">
                            </MudIcon>
                        </ActivatorContent>
                        <ChildContent>
                            <MudMenuItem>
                                <MudButton OnClick="@(()=>Login())" Color="Color.Inherit">
                                    <MudText>
                                        <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Person"
                                            Size="Size.Small">
                                        </MudIcon>
                                        <SystemText TextId=SystemTextId.Login FallbackText="Login"
                                            IsFirstLoaded="@IsFirstLoaded">
                                        </SystemText>
                                    </MudText>
                                </MudButton>
                            </MudMenuItem>
                            <MudDivider />
                            <MudMenuItem>
                                <MudButton OnClick="@(()=>Register())" Color="Color.Inherit">
                                    <MudText>
                                        <MudIcon class="text-icon" Icon="@Icons.Material.Filled.Add" Size="Size.Small">
                                        </MudIcon>
                                        <SystemText TextId=SystemTextId.Register FallbackText="Become a member"
                                            IsFirstLoaded="@IsFirstLoaded"></SystemText>
                                    </MudText>
                                </MudButton>
                            </MudMenuItem>
                        </ChildContent>
                    </MudMenu>
                </ChildContent>
                <TooltipContent>
                    <SystemText TextId=SystemTextId.Login FallbackText="Login" IsFirstLoaded="@IsFirstLoaded">
                    </SystemText>/<SystemText TextId=SystemTextId.Register FallbackText="Become a member"
                        IsFirstLoaded="@IsFirstLoaded"></SystemText>
                </TooltipContent>
            </MudTooltip>
        </NotAuthorized>
    </AuthorizeView>
    @if (_isLightMode)
    {
        <MudIconButton Icon="@Icons.Material.Filled.Brightness4" Color="Color.Inherit" OnClick="ToggleTheme" />
    }
    else
    {
        <MudIconButton Icon="@Icons.Material.Filled.Brightness5" Color="Color.Inherit" OnClick="ToggleTheme" />
    }
</MudAppBar>